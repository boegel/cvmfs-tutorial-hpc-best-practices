
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../troubleshooting/">
      
      
        <link rel="next" href="../containers/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>Performance aspects - Best Practices for CernVM-FS in HPC</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fad675c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#performance-aspects-of-cernvm-fs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Best Practices for CernVM-FS in HPC" class="md-header__button md-logo" aria-label="Best Practices for CernVM-FS in HPC" data-md-component="logo">
      
  <img src="../img/logos/cvmfs_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Best Practices for CernVM-FS in HPC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Performance aspects
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/multixscale/cvmfs-tutorial-hpc-best-practices" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Best Practices for CernVM-FS in HPC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Best Practices for CernVM-FS in HPC" class="md-nav__button md-logo" aria-label="Best Practices for CernVM-FS in HPC" data-md-component="logo">
      
  <img src="../img/logos/cvmfs_logo.png" alt="logo">

    </a>
    Best Practices for CernVM-FS in HPC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/multixscale/cvmfs-tutorial-hpc-best-practices" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Best Practices for CernVM-FS in HPC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to CernVM-FS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to CernVM-FS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cvmfs/what-is-cvmfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is CernVM-FS?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cvmfs/technical-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cvmfs/flagship-repositories/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flagship repositories
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EESSI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            EESSI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/what-is-eessi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is EESSI?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/motivation-goals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation & goals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/inspiration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inspiration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/high-level-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-level design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/using-eessi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using EESSI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi/support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting support
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Accessing repositories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Accessing repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access/client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CernVM-FS client system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access/proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Squid proxy server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access/stratum1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Stratum 1 replica server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access/alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternative access methods
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration_hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration on HPC systems
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting and debugging
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Performance aspects
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Performance aspects
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#start-up-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Start-up performance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test_workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Test workloads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-status" class="md-nav__link">
    <span class="md-ellipsis">
      Cache status
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cache status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cold_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Cold cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Hot cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warm_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Warm cache
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-results" class="md-nav__link">
    <span class="md-ellipsis">
      Performance results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorflow-start-up" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFlow start-up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow start-up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-filesystems" class="md-nav__link">
    <span class="md-ellipsis">
      Local filesystems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-filesystems" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel filesystems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cernvm-fs" class="md-nav__link">
    <span class="md-ellipsis">
      CernVM-FS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpi-start-up" class="md-nav__link">
    <span class="md-ellipsis">
      MPI start-up
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-configuration-details" class="md-nav__link">
    <span class="md-ellipsis">
      Test configuration details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test configuration details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-system" class="md-nav__link">
    <span class="md-ellipsis">
      Client system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Software stack
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test_workload_details" class="md-nav__link">
    <span class="md-ellipsis">
      Test workload details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test workload details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorflow_details" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFlow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-files" class="md-nav__link">
    <span class="md-ellipsis">
      Required files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpi_init_details" class="md-nav__link">
    <span class="md-ellipsis">
      MPI_Init
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental_setup" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system_configurations" class="md-nav__link">
    <span class="md-ellipsis">
      System configurations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relevant-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Relevant commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a CernVM-FS repository
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Appendix: Terminology
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#start-up-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Start-up performance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test_workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Test workloads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-status" class="md-nav__link">
    <span class="md-ellipsis">
      Cache status
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cache status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cold_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Cold cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Hot cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warm_cache" class="md-nav__link">
    <span class="md-ellipsis">
      Warm cache
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-results" class="md-nav__link">
    <span class="md-ellipsis">
      Performance results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorflow-start-up" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFlow start-up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow start-up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-filesystems" class="md-nav__link">
    <span class="md-ellipsis">
      Local filesystems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-filesystems" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel filesystems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cernvm-fs" class="md-nav__link">
    <span class="md-ellipsis">
      CernVM-FS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpi-start-up" class="md-nav__link">
    <span class="md-ellipsis">
      MPI start-up
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-configuration-details" class="md-nav__link">
    <span class="md-ellipsis">
      Test configuration details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test configuration details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-system" class="md-nav__link">
    <span class="md-ellipsis">
      Client system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Software stack
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test_workload_details" class="md-nav__link">
    <span class="md-ellipsis">
      Test workload details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test workload details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorflow_details" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFlow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-files" class="md-nav__link">
    <span class="md-ellipsis">
      Required files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpi_init_details" class="md-nav__link">
    <span class="md-ellipsis">
      MPI_Init
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental_setup" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system_configurations" class="md-nav__link">
    <span class="md-ellipsis">
      System configurations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relevant-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Relevant commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="performance-aspects-of-cernvm-fs">Performance aspects of CernVM-FS<a class="headerlink" href="#performance-aspects-of-cernvm-fs" title="Permanent link">&para;</a></h1>
<p>One aspect we can not ignore in the context of software on HPC infrastructure is <em>performance</em> (the P in HPC).</p>
<h2 id="start-up-performance">Start-up performance<a class="headerlink" href="#start-up-performance" title="Permanent link">&para;</a></h2>
<p>When installations of scientific software applications are provided via a CernVM-FS repository,
the main performance metric to worry about is <strong>start-up time</strong>: the amount of time it takes until an
application can <em>start</em> running. This requires that not only the binary program that is being launched itself
is somehow available on the system (on disk, in memory, etc.), but also that all files required by it
(libraries, dependencies) are available, including the ones they require in turn, etc.</p>
<p>Parallel filesystems like <a href="https://en.wikipedia.org/wiki/GPFS">GPFS (now IBM Storage Scale)</a> and
<a href="https://www.lustre.org">Lustre</a>, which are ubiquitous on HPC systems,
are notorious for not performing well in this respect, which is not surprising since they mainly target a very
different use case: large-scale high-performance I/O on large datasets.</p>
<p>This has led to to all sorts of creative workarounds for "the startup problem",
including for example tools like <a href="https://github.com/hpc/Spindle">Spindle</a>, and recommendations to not install
(in particular Python) software directly on the parallel filesystem but to use a container image instead
(<a href="https://docs.lumi-supercomputer.eu/software/installing/python/">see the documentation of the current flagship EuroHPC system LUMI</a>).</p>
<div class="admonition example">
<p class="admonition-title">A note on the presented performance results</p>
<p>The start-up timing results shown in this section are by no means meant to be a statistically
rigorous study of software start-up time.</p>
<p>That said, these results should be indicative of what you may see on production HPC systems,
and give a good view on the start-up times that you will observe for software provided via CernVM-FS,
relative to alternatives like GPFS, Lustre, NFS, local disk, etc.</p>
<p>More details on the experimental setup are available <a href="#experimental_setup">at the end of this section</a>.</p>
</div>
<h2 id="test_workloads">Test workloads<a class="headerlink" href="#test_workloads" title="Permanent link">&para;</a></h2>
<p>We will present and discuss the start-up timing results for software installed in different file systems,
when being accessed under different circumstances, using two small workloads:</p>
<ul>
<li>Start-up of TensorFlow: <code>python -c 'import tensorflow'</code> (<a href="#tensorflow_details">see details below</a>)</li>
<li>MPI startup (<code>MPI_init</code>), via <code>osu_init</code> microbenchmark (<a href="#mpi_init_details">see details below</a>)</li>
</ul>
<h2 id="cache-status">Cache status<a class="headerlink" href="#cache-status" title="Permanent link">&para;</a></h2>
<p>The status of the Linux kernel file system cache, and the CernVM-FS client cache (when relevant)
is a key factor in start-up performance.</p>
<p>We discriminate between 3 scenarios: <a href="#cold_cache">cold cache</a>, <a href="#hot_cache">hot cache</a>, and <a href="#warm_cache">warm cache</a>.</p>
<h3 id="cold_cache">Cold cache<a class="headerlink" href="#cold_cache" title="Permanent link">&para;</a></h3>
<h3 id="hot_cache">Hot cache<a class="headerlink" href="#hot_cache" title="Permanent link">&para;</a></h3>
<h3 id="warm_cache">Warm cache<a class="headerlink" href="#warm_cache" title="Permanent link">&para;</a></h3>
<h2 id="performance-results">Performance results<a class="headerlink" href="#performance-results" title="Permanent link">&para;</a></h2>
<h3 id="tensorflow-start-up">TensorFlow start-up<a class="headerlink" href="#tensorflow-start-up" title="Permanent link">&para;</a></h3>
<h4 id="local-filesystems">Local filesystems<a class="headerlink" href="#local-filesystems" title="Permanent link">&para;</a></h4>
<p><a href="https://tacc.utexas.edu/use-tacc/software-list">https://tacc.utexas.edu/use-tacc/software-list</a></p>
<p align="center">
<img src="../img/perf/tensorflow-startup-local-fs-cold-vs-hot.png" alt="Start-up performance of TensorFlow: local disk vs RAM disk" width="100%"/></br>
</p>

<h4 id="parallel-filesystems">Parallel filesystems<a class="headerlink" href="#parallel-filesystems" title="Permanent link">&para;</a></h4>
<p align="center">
<img src="../img/perf/tensorflow-startup-lustre.png" alt="Start-up performance of TensorFlow: Lustre" width="100%"/></br>
</p>

<p align="center">
<img src="../img/perf/tensorflow-startup-gpfs.png" alt="Start-up performance of TensorFlow: Lustre" width="100%"/></br>
</p>

<h4 id="cernvm-fs">CernVM-FS<a class="headerlink" href="#cernvm-fs" title="Permanent link">&para;</a></h4>
<p align="center">
<img src="../img/perf/tensorflow-startup-cvmfs-cold.png" alt="Start-up performance of TensorFlow: CernVM-FS (cold
caches)" width="90%"/></br>
</p>

<p align="center">
<img src="../img/perf/tensorflow-startup-cvmfs-hot-warm.png" alt="Start-up performance of TensorFlow: CernVM-FS (hot + warm cache)" width="100%"/></br>
</p>

<h3 id="mpi-start-up">MPI start-up<a class="headerlink" href="#mpi-start-up" title="Permanent link">&para;</a></h3>
<h2 id="test-configuration-details">Test configuration details<a class="headerlink" href="#test-configuration-details" title="Permanent link">&para;</a></h2>
<p>A multitude of different system configurations is considered to evaluate start-up performance
of the <a href="#test_workload_details">test workloads</a>.</p>
<h3 id="client-system">Client system<a class="headerlink" href="#client-system" title="Permanent link">&para;</a></h3>
<p>The client system used in the tests is a worker node of the HPC-UGent Tier-2 cluster "doduo", with two exceptions:</p>
<ul>
<li>When testing NFS, the HPC-UGent Tier-2 cluster "victini" was used instead;</li>
<li>When testing Lustre, the VSC Tier-1 cluster "Hortense" was used instead;</li>
</ul>
<p><em>(see <a href="#system_configurations">System configurations</a> below for more technical details)</em></p>
<h3 id="software-stack">Software stack<a class="headerlink" href="#software-stack" title="Permanent link">&para;</a></h3>
<p>Software installations being used are available via either:</p>
<ul>
<li>a GPFS filesystem, directly attached to the cluster via a high-speed network;</li>
<li>a Lustre filesystem, directly attached to the cluster via a high-speed network;</li>
<li>an NFS mount of a GPFS filesystem, via a 10Gbit Ethernet connection;</li>
<li>CernVM-FS, with:<ul>
<li>with a client cache on local disk (SSD, <code>ext4</code>), or in RAM disk (<code>/dev/shm</code>);</li>
<li>without and with (only) a (private) proxy server in the local network;</li>
<li>without and with (only) a private Stratum 1 replica server in the network;</li>
<li>with (only) a <em>specific</em> public Stratum 1 replica server: one in AWS <code>eu-west</code> region,
  another in Azure <code>us-east</code> region;</li>
</ul>
</li>
</ul>
<p><em>(see <a href="#system_configurations">System configurations</a> below for more technical details)</em></p>
<h2 id="test_workload_details">Test workload details<a class="headerlink" href="#test_workload_details" title="Permanent link">&para;</a></h2>
<p>We will present and discuss the start-up timing results for software installed in different file systems,
when being accessed under different circumstances, using two small workloads:</p>
<ul>
<li><a href="#tensorflow">Start-up of TensorFlow (<code>python -c 'import tensorflow'</code>)</a></li>
<li><a href="#mpi_init">MPI startup (<code>MPI_init</code>, via <code>osu_init</code> microbenchmark)</a></li>
</ul>
<h3 id="tensorflow_details">TensorFlow<a class="headerlink" href="#tensorflow_details" title="Permanent link">&para;</a></h3>
<p>We evaluate the start-up performance of <a href="https://www.tensorflow.org">TensorFlow</a>,
which is considered to be a representative example of a scientific workload implemented in
<a href="https://www.python.org/">Python</a>, which is a tremendously popular programming language in scientific research.
We used TensorFlow version 2.13.0, installed with <a href="https://easybuild.io">EasyBuild</a> v4.8.2,
on top of Python version 3.11.3, which is available in <a href="../eessi/">EESSI</a>.</p>
<p>Before starting TensorFlow we first load the module to update the environment such
that TensorFlow is available:</p>
<div class="copy highlight"><pre><span></span><code>module<span class="w"> </span>load<span class="w"> </span>TensorFlow/2.13.0-foss-2023a
</code></pre></div>
<p>To evaluate the start-up performance of TensorFlow, we simply run:</p>
<div class="copy highlight"><pre><span></span><code>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import tensorflow&#39;</span>
</code></pre></div>
<p>Timing information is collected using the GNU <code>time</code> command, as follows:</p>
<div class="copy highlight"><pre><span></span><code>/usr/bin/time<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;%e&#39;</span><span class="w"> </span>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import tensorflow&#39;</span>
</code></pre></div>
<h4 id="required-files">Required files<a class="headerlink" href="#required-files" title="Permanent link">&para;</a></h4>
<p>Based on the statistics for and contents of the CernVM-FS client cache after running the specified command,
starting from a cold CernVM-FS client cache, we know that importing the <code>tensorflow</code> Python package:</p>
<ul>
<li>triggers ~11,000 <code>open()</code> calls + ~1,500 <code>opendir</code> calls (which includes non-existing paths);</li>
<li>requires ~3,500 files, including:<ul>
<li>~2,200 files from the TensorFlow installation itself (~94% <code>*.pyc</code> files);</li>
<li>~1,300 files from Python packages outside of the TensorFlow installation directory,
   of which ~76% <code>*.pyc</code> files, ~14% shared libraries (<code>.so</code>);</li>
<li>~30 files from the <a href="../eessi/high-level-design/#compat_layer">EESSI compatibility layer</a>;</li>
</ul>
</li>
</ul>
<p>As such, this is a challenge for parallel filesystems like GPFS and Lustre, as the results will show.</p>
<h3 id="mpi_init_details"><code>MPI_Init</code><a class="headerlink" href="#mpi_init_details" title="Permanent link">&para;</a></h3>
<h2 id="experimental_setup">Experimental setup<a class="headerlink" href="#experimental_setup" title="Permanent link">&para;</a></h2>
<h3 id="system_configurations">System configurations<a class="headerlink" href="#system_configurations" title="Permanent link">&para;</a></h3>
<details class="note">
<summary>HPC-UGent Tier-2 cluster 'doduo'</summary>
<p>Hardware:</p>
<ul>
<li>Dual-socket AMD EPYC 7552 CPU (AMD Rome, 96 cores in total)</li>
<li>256GB of DDR4 RAM memory</li>
<li>240GB SSD local disk (<code>ext4</code>)</li>
<li>HDR-100 InfiniBand interconnect</li>
</ul>
<p>Operating system:</p>
<ul>
<li>Red Hat Enterprise Linux 8.8</li>
<li>Linux kernel <code>4.18.0-477.27.1.el8_8.x86_64</code></li>
<li>GPFS (IBM Storage Scale) version 5.1.8-2 (<code>pagepool=4G</code>, <code>maxStatCache=1000</code>, <code>maxFilesToCache=4000</code>)</li>
<li>CermVM-FS 2.11.2</li>
</ul>
<p><em>(see also <a href="https://www.ugent.be/hpc/en/infrastructure">HPC-UGent Tier-2 infrastructure overview</a>)</em></p>
</details>
<details class="note">
<summary>HPC-UGent Tier-2 cluster 'victini'</summary>
<p>Hardware:</p>
<ul>
<li>Dual-socket AMD EPYC 7552 CPU (AMD Rome, 96 cores in total)</li>
<li>256GB of DDR4 RAM memory</li>
<li>240GB SSD local disk (<code>ext4</code>)</li>
<li>10Gbit Ethernet interconnect</li>
</ul>
<p>Operating system:</p>
<ul>
<li>Red Hat Enterprise Linux 8.8</li>
<li>Linux kernel <code>4.18.0-477.27.1.el8_8.x86_64</code></li>
<li>NFS-Ganesha 3.5</li>
<li>CermVM-FS 2.11.2</li>
</ul>
<p><em>(see also <a href="https://www.ugent.be/hpc/en/infrastructure">HPC-UGent Tier-2 infrastructure overview</a>)</em></p>
</details>
<details class="note">
<summary>VSC Tier-1 cluster 'Hortense'</summary>
<p>Hardware:</p>
<ul>
<li>Dual-socket Intel Xeon Gold 6140 (CPU Skylake, 36 cores in total)</li>
<li>96GB of DDR4 RAM memory</li>
<li>900GB SAS HDD local disk (<code>ext4</code>)</li>
<li>HDR-100 InfiniBand interconnect</li>
</ul>
<p>Operating system:</p>
<ul>
<li>Red Hat Enterprise Linux 8.8</li>
<li>Linux kernel <code>4.18.0-477.27.1.el8_8.x86_64</code></li>
<li>Lustre 2.12.9</li>
<li>CermVM-FS 2.11.2</li>
</ul>
<p><em>(see also <a href="https://docs.vscentrum.be/gent/tier1_hortense.html#hardware-details">VSC documentation page on Hortense</a>)</em></p>
</details>
<details class="note">
<summary>Network details</summary>
<p><strong>Bandwidth</strong></p>
<p>Network bandwidth to HPC-UGent Tier-2 <code>doduo</code> cluster worker node from relevant servers,
as measured with <a href="https://software.es.net/iperf/"><code>iperf3</code> v3.15</a>:</p>
<ul>
<li>private Squid proxy server in HPC-UGent network: ~22,500 Mbits/sec</li>
<li>private Stratum 1 replica server in HPC-UGent network: ~940 Mbits/sec</li>
<li>EESSI Stratum 1 replica server in AWS <code>eu-west</code> region: ~930 Mbits/sec</li>
<li>EESSI Stratum 1 replica server in Azure <code>us-east</code> region: ~280 Mbits/sec</li>
</ul>
<p>Server-side <code>iperf3</code> command: <code>iperf3 -V -s -p 80</code>
Client-side <code>iperf3</code> command: <code>iperf3 -V -c SERVER_HOSTNAME_OR_IP -p 80 -f m</code></p>
<p><strong>Latency</strong></p>
<p>Network latency between HPC-UGent Tier-2 <code>doduo</code> cluster worker node and relevant servers,
as measured with <a href="https://linux.die.net/man/1/tcptraceroute"><code>tcptraceroute</code> v2.1.0-6</a>:</p>
<ul>
<li>private Squid proxy server in HPC-UGent network: ~0.2 ms</li>
<li>private Stratum 1 replica server in HPC-UGent network: ~0.7 ms</li>
<li>EESSI Stratum 1 replica server in AWS <code>eu-west</code> region: ~14 ms</li>
<li>EESSI Stratum 1 replica server in Azure <code>us-east</code> region: ~84 ms</li>
</ul>
</details>
<h3 id="relevant-commands">Relevant commands<a class="headerlink" href="#relevant-commands" title="Permanent link">&para;</a></h3>
<details class="note">
<summary>Kernel file system cache</summary>
<p>To clear kernel file system cache:</p>
<div class="copy highlight"><pre><span></span><code>sudo<span class="w"> </span>sysctl<span class="w"> </span>-w<span class="w"> </span>vm.drop_caches<span class="o">=</span><span class="m">3</span>
</code></pre></div>
<p>To check file system cache usage:</p>
<div class="copy highlight"><pre><span></span><code>vmstat<span class="w"> </span>-s<span class="w"> </span>-S<span class="w"> </span>M<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>buffer
</code></pre></div>
</details>
<details class="note">
<summary>CernVM-FS client cache</summary>
<p>To clear CernVM-FS client cache:</p>
<div class="copy highlight"><pre><span></span><code>sudo<span class="w"> </span>cvmfs_config<span class="w"> </span>wipecache
</code></pre></div>
<p>To check CernVM-FS client cache usage:</p>
<div class="copy highlight"><pre><span></span><code>cvmfs_config<span class="w"> </span>stat<span class="w"> </span>-v
</code></pre></div>
<p>To check CernVM-FS client cache usage for a particular repository:</p>
<div class="copy highlight"><pre><span></span><code>cvmfs_config<span class="w"> </span>stat<span class="w"> </span>-v<span class="w"> </span>software.eessi.io
</code></pre></div>
<p>To check size of CernVM-FS client cache on disk (path determined by <code>CVMFS_CACHE_BASE</code> configuration setting):</p>
<div class="copy highlight"><pre><span></span><code>du<span class="w"> </span>-sh<span class="w"> </span>/var/lib/cvmfs
</code></pre></div>
</details>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 2, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["instant"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
    
  </body>
</html>